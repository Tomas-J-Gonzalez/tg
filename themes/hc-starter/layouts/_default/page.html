{{ define "main" }}

  <article>
    <header class="Hero region flow">
      <h1>{{ .Title }}</h1>
      {{ with .Params.subtitle }}
        <p class="font-step-1">{{ . }}</p>
      {{ end }}
      <div> 
        {{ $published := .PublishDate | time.Format ":date_medium" }}
        {{ $modified := .Lastmod | time.Format ":date_medium" }}
        {{ if ne $published $modified }}
        <span class="Badge"> Updated: {{ .Lastmod.Format "Jan 2 2006" }} </span>
        {{ end }}
      </div>
    </header>

    <section class="e-content flow">
      {{ if .Params.blocks }}
        {{- range .Params.blocks -}}
            {{- if eq .template "hero" -}}{{ partial "blocks/hero" (dict "Params" . "baseURL" $.Site.Params.cloudinary_url ) }}{{- end -}}
            {{- if eq .template "image-full" -}}{{ partial "blocks/img-full" (dict "Params" . "baseURL" $.Site.Params.cloudinary_url ) }}{{- end -}}
            {{- if eq .template "body-copy" -}}{{ partial "blocks/content" (dict "Params" .) }}{{- end -}}
            {{- if eq .template "image-grid-two" -}}{{ partial "blocks/img-grid-two" (dict "Params" . "baseURL" $.Site.Params.cloudinary_url) }}{{- end -}}
            {{- if eq .template "image-grid-four" -}}{{ partial "blocks/img-grid-four" (dict "Params" . "baseURL" $.Site.Params.cloudinary_url) }}{{- end -}} 
            {{- if eq .template "quote" -}}{{ partial "blocks/quote" (dict "Params" . "baseURL" $.Site.Params.cloudinary_url) }}{{- end -}} 
            {{- if eq .template "link-big" -}}{{ partial "blocks/link-big" (dict "Params" .) }}{{- end -}} 
            {{- if eq .template "video" -}}{{ partial "blocks/video" (dict "Params" .) }}{{- end -}} 
            {{- if eq .template "image" -}}{{ partial "blocks/image" (dict "Params" .) }}{{- end -}} 
            {{- if eq .template "iframe-full" -}}{{ partial "blocks/iframe-full" (dict "Params" .) }}{{- end -}} 
            {{- if eq .template "iframe-grid-one" -}}{{ partial "blocks/iframe-grid-one" (dict "Params" .) }}{{- end -}} 
            {{- if eq .template "iframe-grid-two" -}}{{ partial "blocks/iframe-grid-two" (dict "Params" .) }}{{- end -}} 
        {{- end -}}
      {{ else }}
        {{ partial "heading-anchor.html" .Content }}
      {{ end }}
    </section>
  </article><!--/.Content -->

  <!-- render if URL returns true -->
  {{- if eq .RelPermalink "/learn-hugo/" }}
    <!-- grab updates -->
    {{ $updates := where .Site.RegularPages "Type" "updates" }}  
    <ul>
    <!-- loop through updates -->
    {{ range $updates }}
      <!-- render if topic returns true -->
      {{ if in .Params.topics "Hugo course" }}
        <li>
          <a href="{{ .Permalink }}">{{ .Date.Format "Jan 2, 2006" }} â€“ {{ .Title }}</a>
        </li>   
      {{ end }}
    {{ end }}
    </ul>
  {{ end }}

  {{- if eq .RelPermalink "/testimonials/" }}
    {{ partial "reply-by-email.html" (dict "Page" . "button_text" "Write a testimonial" ) }}
  {{- end }}

{{ end }}